syntax = "proto3";
import "Contracts/Common.proto";

package InsightServices;

service InsightsService {
  rpc TopLoanedBooks(TopLoanedBooksRequestMsg) returns (TopLoanedBooksResponseMsg);
  rpc TopMembersByLoanCount(TopMembersByLoanCountRequestMsg) returns (TopMembersByLoanCountResponseMsg);
  rpc MemberReadingPace(MemberReadingPaceRequestMsg) returns (MemberReadingPaceResponseMsg);
  rpc LoaningPatternByBooks(LoaningPatternByBookRequestMsg) returns (LoaningPatternByBookResponseMsg);
}


// Most Loaned book
message TopLoanedBooksRequestMsg {
  int32 PageNumber = 1;
  int32 PageSize = 2;
}
message TopLoanedBooksRow {
  int64 BookId = 1;
  string Title = 2;
  int32 Count = 3;
}
message TopLoanedBooksResponseMsg {
  repeated TopLoanedBooksRow Items = 1;
  int32 PageNumber = 2;
  int32 PageSize = 3;
  int32 TotalItems = 4;
}

//Top Borrowers
message TopMembersByLoanCountRequestMsg {
  int32 PageNumber = 1;
  int32 PageSize = 2;
  Common.TimeRangeMsg Range = 3;
}
message TopMembersByLoanCountRow  {
  int64 MemberId = 1;
  string DisplayName = 2;
  int32 LoanCount = 3;
}
message TopMembersByLoanCountResponseMsg {
  repeated TopMembersByLoanCountRow  Items = 1;
  int32 PageNumber = 2;
  int32 PageSize = 3;
  int32 TotalItems = 4;
}

// reading pace
message MemberReadingPaceRequestMsg {
  int64 MemberId = 1;
}

message MemberReadingPaceRow{
  int64 BookId = 1;
  string Title = 2;
  Common.DecimalValue readingPace = 3;
}
message MemberReadingPaceResponseMsg {
  double OverallReadingPagesPerDay = 1;
  repeated MemberReadingPaceRow Books = 2;
}

//Co-Loaned books
message LoaningPatternByBookRequestMsg{
  int32 PageNumber = 1;
  int32 PageSize = 2;
  int64 BookId = 3;
}
message LoaningPatternByBookResponseMsg{
  repeated Common.BookMsg Items = 1;
  int32 PageNumber = 2;
  int32 PageSize = 3;
  int32 TotalItems = 4;
}

