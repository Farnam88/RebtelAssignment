syntax = "proto3";
import "Contracts/Common.proto";

package InsightServices;

service InsightsService {
  rpc MostLoanedBooks(MostLoanedBooksRequest) returns (MostLoanedBooksResponse);
  rpc TopMembersByLoanCount(TopMembersByLoanCountRequest) returns (TopMembersByLoanCountResponse);
  rpc EstimateReadingPace(EstimateReadingPaceRequest) returns (EstimateReadingPaceResponse);
  rpc CoLoanedBooks(CoLoanedBooksRequest) returns (CoLoanedBooksResponse);
}


// Most Loaned book
message MostLoanedBooksRequest {
  int32 PageNumber = 1;
  int32 PageSize = 2;
  Common.TimeRange Range = 3;
}
message MostLoanedBooksRow {
  int64 BookId = 1;
  string Title = 2;
  int64 Count = 3;
}
message MostLoanedBooksResponse {
  repeated MostLoanedBooksRow Items = 1;
  int32 PageNumber = 2;
  int32 PageSize = 3;
  int64 TotalRecords = 4;
}

//Top Borrowers
message TopMembersByLoanCountRequest {
  int32 PageNumber = 1;
  int32 PageSize = 2;
  Common.TimeRange Range = 3;
}
message TopMembersByLoanCountRow  {
  int64 MemberId = 1;
  string DisplayName = 2;
  int64 Count = 3;
}
message TopMembersByLoanCountResponse {
  repeated TopMembersByLoanCountRow  rows = 1;
}

// reading pace
message EstimateReadingPaceRequest {
  int64 MemberId = 1;
}
message ReadingPaceRow {
  int64 BatchId = 1;
  int64 BookId = 2;
  int64 Pages = 3;
  Common.DecimalValue PagePerDay = 4;
}
message EstimateReadingPaceResponse {
  double OverallPagesPerDay = 1;
  repeated ReadingPaceRow ReadingPacePerBook = 2;
}

//Co-Loaned books
message CoLoanedBooksRequest{
  int32 PageNumber = 1;
  int32 PageSize = 2;
  int64 BookId = 3;
}
message CoLoanedBooksRow{
  int64 BookId = 1;
  int64 Count = 2;
  repeated Common.Member Members = 3;
}
message CoLoanedBooksResponse{
  repeated CoLoanedBooksRow Items = 1;
  int32 PageNumber = 2;
  int32 PageSize = 3;
  int64 TotalRecords = 4;
}

